{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst instance = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n    params: {\n        key: '48884243-7c5376715b9f7ca682882ed04',\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: '40',\n    }\n\n});\n\nlet page = 1;\n\nexport async function getImgs(imgsOf, page) { \n    \n    try {\n        const r = await instance.get('', {\n            params: {\n                q: imgsOf,\n                per_page: 40,\n                page: page,\n            }\n        });\n        if (r.data.hits.length === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                titleColor: 'white',\n                messageColor: 'white',\n                backgroundColor: 'red',\n                theme: 'dark',\n            });\n            return { hits: [], totalHits: 0 };\n        }\n\n        return {\n            hits: r.data.hits,\n            totalHits: r.data.totalHits\n        };\n    }\n        catch(error) { \n            iziToast.error({\n                title: 'Error',\n                message: 'Please try again',\n                titleColor: 'white',\n                messageColor: 'white',\n                backgroundColor: 'red',\n                theme: 'dark', \n            });\n            return { hits: [], totalHits: 0 };\n        }\n }\n\nexport function resetPage() { \n    page = 1;\n}\n\n","import { getImgs } from \"./pixabay-api\";\n\n\n\nconst refs = {\n    gallery: document.querySelector(\".js-gallery\"),\n    loader: document.querySelector('.js-loader'),\n    loadMoreBtn: document.querySelector('.more-btn'),\n}\n\nexport function createGallery(imgs) {\n    const markup = createMarkup(imgs);\n    refs.gallery.innerHTML += markup;\n    refs.gallery.classList.add('gallery');\n    \n    \n    \n    const totalHits = imgs.length ? imgs[0].totalHits : 0;\n    const currentHits = refs.gallery.children.length;\n    if (currentHits >= totalHits) {\n        refs.loadMoreBtn.style.display = 'none';\n        iziToast.error({\n            title: 'Error',\n            messages: \"We're sorry, but you've reached the end of search results\",\n            titleColor: 'white',\n            messageColor: 'white',\n            backgroundColor: 'red',\n            theme: 'dark',\n        });\n    } else { \n        refs.loadMoreBtn.style.display = 'block';\n    }\n\n}\n\nexport function resetGallery() { \n        refs.gallery.innerHTML = '';\n}\n\n\nfunction imgTemplate(img) { \nconst {webformatURL, largeImageURL, tags, likes, views, comments, downloads} = img;\n    return `<li class=\"js-gallery-item\">\n        <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"158\"/>\n        </a>\n        <ul class=\"stats\">\n          <li class=\"stats-item\">Likes<span class=\"stats-span\">${likes}</span></li>\n          <li class=\"stats-item\">Comments<span class=\"stats-span\">${comments}</span></li>\n          <li class=\"stats-item\">Views<span class=\"stats-span\">${views}</span></li>\n          <li class=\"stats-item\">Downloads<span class=\"stats-span\">${downloads}</span></li>\n        </ul>\n      </li>`;\n}\n\nfunction createMarkup(arr) { \n    return arr.map(imgTemplate).join('');\n}\n\nexport function scroll() { \n    const galleryItem = document.querySelector('.js-gallery-item');\n    if (!galleryItem) return;\n    const postHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n        top: postHeight * 3.20,\n        behavior: 'smooth'\n    });\n}","import { getImgs, resetPage } from './js/pixabay-api.js';\nimport { createGallery, resetGallery, scroll } from './js/render-functions.js'\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\n\nconst refs = {\n    searchForm: document.querySelector(\".js-search-form\"),\n    loader: document.querySelector('.js-loader'),\n    gallery: document.querySelector('.js-gallery'),\n    loadMoreBtn: document.querySelector('.more-btn'),\n\n}\n\nlet currentlySearched = '';\nlet page = 1;\nlet totalHits = 0;\nlet galleryModals;\n\nrefs.searchForm.addEventListener(\"submit\", handleSubmit);\n\nasync function handleSubmit(e) { \n    e.preventDefault();\n\n\n    const request = e.target.elements['search-bar'].value;\n\n    currentlySearched = request;\n\n    resetGallery();\n    resetPage();\n\n    refs.loadMoreBtn.style.display = 'none';\n    refs.loader.style.display = 'block';\n\n    page = 1;\n\n\n    const imgs = await getImgs(currentlySearched, page);\n    const { hits, totalHits } = imgs;\n\n        if (hits.length === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Invalid query. Try again',\n            });\n        } else { \n            createGallery(hits);\n            galleryModals = new SimpleLightbox('.gallery a');\n        }\n    \n    imgCountReached(hits);\n\n   \n\n    if (totalHits > 40) { \n        refs.loadMoreBtn.style.display = 'block';\n    }\n\n    refs.loader.style.display = 'none';\n\n    \n\n    e.target.reset();\n}\n\nrefs.loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\nasync function handleLoadMore() {\n\n    refs.loader.style.display = 'block';\n    \n    const imgs = await getImgs(currentlySearched, page);\n    const { hits, totalHits } = imgs;\n\n    createGallery(hits);\n    imgCountReached(hits);\n    galleryModals.refresh();\n         \n    page++;\n    checkLimit(totalHits);\n    refs.loader.style.display = 'none';\n    \n    scroll();\n}\n\nfunction imgCountReached(hits) {\n    if (hits.length < 40) { \n        refs.loadMoreBtn.style.display = 'none';\n        refs.loader.style.display = 'none';\n        iziToast.info({\n            message: 'No more images could be found under the current query',\n        });\n    }\n}  \n\nfunction checkLimit(totalHits) { \n\n    if (page * 40 >= totalHits) { \n            refs.loadMoreBtn.style.display = 'none';\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n\n            });\n\n    }\n\n}\n\n\n"],"names":["instance","axios","getImgs","imgsOf","page","r","iziToast","refs","createGallery","imgs","markup","createMarkup","totalHits","resetGallery","imgTemplate","img","webformatURL","largeImageURL","tags","likes","views","comments","downloads","arr","scroll","galleryItem","postHeight","currentlySearched","galleryModals","handleSubmit","hits","SimpleLightbox","imgCountReached","handleLoadMore","checkLimit"],"mappings":"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"}